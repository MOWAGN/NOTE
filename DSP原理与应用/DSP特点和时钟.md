# DSP特点和时钟
## TMS320F2812的主要特点
- 采用高性能静态CMOS制造工艺
    - 主频150MHZ(时钟周期6.67ns)
    - 低功耗（核心电压1.9V, I/O口电压3.3V）
    - Flash 编程电压为3.3V
- 支持JTAG（Joint Test Action Group）边沿扫描
    - 支持片上调试
- 高性能32位CPU
    - 16位×16位和32位×32位乘和累加操作
        - 🌂 51单片机是8位×8位
    - 程序和数据空间分开寻址（哈佛总线结构）
    - 快速中断响应和处理
    - 统一寄存器编程模式
    - 可用数据和程序空间为4M字
    - 高效的代码转换能力（支持C/C++和汇编语言）
- 片内存储器
    - 128K×16位Flash存储器
    - 1K×16位的OTP ROM（固定掩膜ROM)
    - 18K×16位的RAM
        - \*Lo和L1：两块4K×16位 **SRAM**（静态RAM）
        - \*HO：8K×16位RAM
        - \*MO和M1：两块1K×16位RAM
- 4K×16位引导ROM（Boot ROM） 
    - 存放出厂时固化程序
    - 带有软件的Boot模式
    - 标准的数学表
- 外部扩展接口（XINTF）
    - 五个独立存储区域
        - Z0/Z1(8K×16）
        - Z2/Z6(0.5M×16）
        - Z7(16K×16)
    - 可扩展外设、程序/数据存储器
- 时钟与系统控制
    - 支持动态的改变锁相环（PLL）的频率
    - 片上振荡器
    - 看门狗定时器模块
- 三个外部中断
    - 🐖 不代表只能处理3个中断，结合PIE模块可以处理96个模块
    - 可屏蔽中断
    - 非屏蔽中断
- 外部中断扩展（PIE）模块
    - 支持96个外部中断，当前仅使用了45个外部中断
- 128位的密钥/锁（Security Key/Lock）
    - 保护Flash/OTP ROM和L0/L1 SRAM
    - 防止固化在ROM中的程序被盗
- 3个32位的CPU定时器
- 马达（电机）控制外围设备
    - 2个事件管理器（EVA,EVB）
- 串行外围设备
    - 串行外部设备接口SPI ( Serial Peripheral lnterface)
    - 2个串行通信接口SCI（Serial Communication Interface）
    - 改进的局域网络eCAN（用于汽车电器，抗干扰能力较强）
    - 多通道缓冲串行接口（McBSP）和串行外围接口模式
- 12位的ADC，有16通道
    - 2个8通道的输入多路选择器
    - 两个采样保持器
    - 单个的转换时间200ns
    - 单路转换时间60ns
- 多达56个独立的可编程、多用途通用输入/输出（GPIO）引脚
    - 单片机仅为32个I/O口（共40个引脚），共分为P0~P3四组，P3有第二功能
    - DSP的56个I/O引脚都具有第二功能
- 高级的仿真特性
    - 分析和设置断点的功能
    - 实时的硬件调试
- 开发工具
    - ANSI C/C++编译器/会变程序连接器
    - 支持TMS320C24x的指令
    - 代码编辑集成环境
    - DSP/BIOS
    - JTAG扫描控制器，与仿真器连接
    - 硬件评估板
- 低功耗模式和节能模式
    - 支持IDLE模式、HALT模式、STANDBY模式
    - 停止单个外围的时钟
- 封装方式
    - 带外部存储器接口的179脚的球形触点BGA封装
        - ![](vx_images/261925919226013.png =600x)
    - 带外部存储器接口的176脚的脚PGF LQFP封装
        - ![](vx_images/27602819238775.png =600x)
    - 没有外部存储器接口的128脚 LQFP封装
    - BGA-Ball Grid Array球形栅格阵列
    - PGF LQFP-Low-profile Quad Flatpack 低剖面四边扁平。 PBK LOFP

### 信号引脚分类
- 共176个引脚
    - 地址总线：19条
    - 数据总线：16条
    - 读写、片选、外部保持等信号：10条
    - JTAG信号：14条
    - ADC输入信号：31条
    - 电源引脚：30条
    - GPIO或事件管理器信号：56条

### 引脚功能和信号描述
- 见课本p14
- ![](vx_images/413353019226642.png =600x)

### F281x功能框图
![](vx_images/90143519239477.png =700x)
![](vx_images/331113519236032.png =600x)
- 对照：MCS51框图和内核
![](vx_images/303593819231786.png =500x)

## CPU概述
- 在TMS320C2000系列中，CPu内核为
    - c20x/C24x/C240x/C27x/C28x
- TMS320C28x系列芯片有3个主要组成部分
    - 中央处理单元CPU
        - 本芯片的CPU是一种低功耗的 **32位定点** 数字信号处理器
        - 采用改进型哈佛结构（可以并行执行指令和读取数据）和循环寻址方式
        - 精简指令集 RISC（Reduction Instruction Set Computer）
        - 支持字节组合于拆分、位操作等
    - 存储器
    - 片内外设

### CPU组成
![](vx_images/520860820248453.png =500x)
- DSP的CPU中集合了仿真逻辑
    - JTAG仿真器：停止CPU运行，继续运行，查看/修改寄存器，查看/修改内存，设置软件/硬件断点，设置硬件观察点”等工作。
    - 单片机仿真器：属于替代式仿真，这时仿真器完全代替芯片工作，模拟出芯片的时序，**电路板上不需要有也不能有芯片** !
    - 侵入式仿真：是针对内部集成仿真逻辑或仿真固件的芯片开发的仿真技术。侵入式仿真的特点和替代式仿真刚好相反，"仿真器"只起控制仿真过程的作用，时序都是芯片自己产生的。

### CPU信号
- CPU有4种主要信号
    - 存储器接口信号（Memory-interface signals）
        - 这些信号在CPU、存储器和外围设备之间进行数据传送；进行程序存储器的访问和数据存储器的存取；并能根据不同的字段长度区分不同的存取操作（16位或32位）。
    - 时钟和控制信号(Clock and control signals)
        - 这些信号为CPu和仿真逻辑提供时钟，它们可以用来监视和控制CPU。
    - 复位和中断信号(Reset and interruptsignals)
        - 这些信号用来产生硬件复位和中断，并用来监视中断的状态。
    - 仿真信号(Emulation signals)
        - 这些信号用来仿真和调试。

### CPU结构及总线
#### CPU结构
- DSP的CPU主要进行 **取数、运算（加、乘、移位等）**。包括：**输入定标移位器、中央算术逻辑单元(CALU)和乘法单元等**
    - ![](vx_images/98233120243589.png =450x)
- CPU的主要单元
    1. 程序和数据控制逻辑
        - 用来存储从程序存储器中取出的指令序列
    2. 实时仿真逻辑
        - 实现可视化操作
    3. 地址寄存器算术单元ARAU
        - 为从数据存储器中取出的值分配地址
            - 对于数据读操作，把地址放在数据读地址总线DRAB上
            - 对于数据写操作，把地址装入数据写地址总线DWAB上
            - ARAU也可以改变SP和辅助寄存器XAR7~XAR0的值
    4. 算术逻辑单元ALU
        - 32位的ALU可以完成二进制补码运算和布尔运算
            - 运算前，ALU从寄存器、数据存储器或程序控制逻辑中接收数据
            - 运算后，ALU将数据存入寄存器和数据存储器
    5. 程序和数据地址发生器
    6. 定点乘法器
        完成32×32位的二进制补码乘法运算，获得64位的乘积
    7. 中断处理

#### 地址和数据总线
- 存储器接口有 **3组地址总线**
    1. PAB（Program Address Bus）程序地址总线
        - PAB用来传送来自 **程序空间** 的 **读/写** 地址
        - PAB是一个22位总线
    2. DRAB（Data-Read Address Bus）数据读地址总线
        - 32位的DRAB用来传送来自 **数据空间** 的读地址
    3. DWAB（Data-Write Address Bus）数据写地址总线
        - - 32位的DWAB用来传送来自 **数据空间** 的写地址
- 存储器接口有 **3组数据总线**
    1. PRDB（Program-Read DateBus）程序读数据总线
        - PRDB在 **读取程序空间** 时用来传送指令或数据。
        - PRDB是一个32位的总线。
    2. DRDB（Data-ReadDataBus）数据读数据总线
        - DRDB在 **读取数据空间** 时用来传送数据。
        - DRDB是一个32位的总线。
    3. DWDB（Data／ Program-WriteDataBus）数据／程序写数据总线
        - 32位的DWDB在对 **数据空间** 和 **程序空间写** 数据时用来传送数据。
- C28x内部总线结构
    - ![](vx_images/286120322237135.png =600x)










## CPU时钟










## DSP看门狗


















